<!DOCTYPE html>
<html lang="en">
<head>
	<title>Ch. 1 Basic Static Techniques</title>
    <link rel='stylesheet' type='text/css' href='/style.css'>
    <link rel='alternate' type='application/rss+xml' title="Ian Kilty&#39;s Webpage RSS" href='/index.xml'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="robots" content="index, follow">
	<meta charset="utf-8">
</head>
<body>
    
        <header>
    <h2 class="heavy" style="text-transform: capitalize;">
        
            notes
        
    </h2>
</header>

        

  
  
  
  
  
  <a href="/" id="" class="navhead heavy">Home</a>

  
  
  
  
  
  <a href="/blog" id="" class="navhead heavy">Blog</a>

  
  
  
  
  
  <a href="/projects" id="" class="navhead heavy">Projects</a>

  
  
  
  
  
  <a href="/notes" id="active" class="navhead heavy">Notes</a>

  
  
  
  
  
  <a href="/blog/index.xml" id="" class="navhead heavy">RSS</a>


        

<h2 class="arttitle heavy">Ch. 1 Basic Static Techniques</h2>
<aside><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#antivirus-scanning">Antivirus Scanning</a></li>
        <li><a href="#strings">Strings</a></li>
        <li><a href="#packing-and-obfuscation">Packing and Obfuscation</a></li>
        <li><a href="#linking">Linking</a></li>
      </ul>
    </li>
  </ul>
</nav></aside>
<div class="page">
    <h3 id="antivirus-scanning">Antivirus Scanning</h3>
<p>Usually a good first step. Antivirus software uses:</p>
<ul>
<li>File signatures - ex. md5 checksum</li>
<li>Patteren matching analysis - heuristics
to identify malicious code.</li>
</ul>
<p>Malware can be bypassed by antimalware by modifying it such that the signature is different, and modify the means of it to bypass the heuristics.</p>
<h3 id="strings">Strings</h3>
<p>To detect the strings in the malware, which may give hints as what it&rsquo;s doing, you can run the strings program to output all the strings of the binary.</p>
<p>The strings program looks for 3 or more letter long unicode strings until the null terminator (some 3 or more letter strings may be useless as the bytes maybe detected as a string).</p>
<h3 id="packing-and-obfuscation">Packing and Obfuscation</h3>
<p><strong>Obfuscation</strong> - the process of making the code less readable or harder to reverse engineer while maintaining the same functionality.</p>
<p><strong>Packing</strong> - Compacted malware that can not be analyzed. Packing compressed the malware such that it generates a wrapper program that can uncompress the malware using the compresion as the encryption.</p>
<p>Both make it harder to statically analyze the malware.</p>
<h4 id="pe">PE</h4>
<p><strong>PE</strong> - Portable Executable, very common executable file in Windows that begins with a header including information about the executable</p>
<p>PEiD - A tool to detect a packed file and the type of packer. <a href="https://www.aldeid.com/wiki/PEiD">https://www.aldeid.com/wiki/PEiD</a></p>
<p>A PE file can have a header, then sections which contatin useful information.</p>
<ul>
<li>.text - The instructions for the CPU, all other sections store data and supporting information. The section is generally the only section that executes and includes code</li>
<li>.rdata - stores import and export data and the read-only data</li>
<li>.data - global data stored by the executable</li>
<li>.rsrc - includes resources not stored in the executable such as images or strings</li>
</ul>
<p>PEview is a useful tool to explore the sections of a PE.</p>
<p>Understanding what imports an executable has can give more information on what the executable is doing.</p>
<h3 id="linking">Linking</h3>
<p><strong>Static linking</strong> - linking libraries by basically inserting the code needed from the library into the executable</p>
<p><strong>Runtime linking</strong> - used to link libraries at runtime, commonly used are <code>LoadLibrary</code> and <code>GetProcAddress</code> allow linking for any library on the system which means you can&rsquo;t see which functions are being linked to by the suspect program</p>
<p><strong>Dynamic linking</strong> - when a library in linked, the host OS searches for the library when the program is loaded and the function is executed within the library</p>
<p>The PE header stores information about what libraries are linked which can give some more info.</p>
<p>Dependancy Walker is a program that lists only the dynamically linked functions of a file.</p>
<p>Sometimes a function is imported by an ordinal which makes it harder to figure what function is being used.</p>
<p>Executables can rarely export functions aswell, DLL&rsquo;s are created to export functions.</p>
<p>Hackers don&rsquo;t typically use the same name for the function as it is in the Microsoft Documentation which makes it harder to find the library.</p>
<p>PEview is a useful tool to explore a PE header. It can give the time of compilation which can be useful, but not always trustworthy.</p>
<p>If the virtual size data point in header is much larger than the raw size, the executable is probably packed as the .text section is larger in memory than on disk.</p>
<h4 id="information-from-a-pe-header">Information from a PE Header</h4>
<ul>
<li>Imports</li>
<li>Exports</li>
<li>Time Date Stamps</li>
<li>Sections - sections in the file, and the sizes on disk and memory</li>
<li>Subsystem - Gui or Cui</li>
<li>Resources - Strings, icons, menu, etc.</li>
</ul>
<p><a href="http://www.angusj.com/resourcehacker/">http://www.angusj.com/resourcehacker/</a> is a good tool to view the PE headers</p>

</div>


    
</body>
</html>
